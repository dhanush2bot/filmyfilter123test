import os
import logging
import random, string
import asyncio
import time
import datetime
from Script import script
from pyrogram import Client, filters, enums
from pyrogram.errors import ChatAdminRequired, FloodWait, ButtonDataInvalid
from pyrogram.types import InlineKeyboardButton, InlineKeyboardMarkup
from database.ia_filterdb import Media, get_file_details, unpack_new_file_id, delete_files
from database.users_chats_db import db
from pyrogram.types import CallbackQuery
from pyrogram.types import Message
from database.connections_mdb import active_connection
from info import INDEX_CHANNELS, ADMINS, IS_VERIFY, VERIFY_TUTORIAL, VERIFY_EXPIRE, TUTORIAL, SHORTLINK_API, SHORTLINK_URL, AUTH_CHANNEL, DELETE_TIME, SUPPORT_LINK, UPDATES_LINK, LOG_CHANNEL, PICS, PROTECT_CONTENT, DATABASE_URL
from utils import get_settings, get_size, is_subscribed, is_check_admin, get_shortlink, get_verify_status, update_verify_status, save_group_settings, temp, get_readable_time, get_wish, get_seconds
import re
import json
import base64
import sys
from shortzy import Shortzy
from telegraph import upload_file


@Client.on_message(filters.command("start") & filters.incoming)
async def start(client, message):
    if message.chat.type in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        if not await db.get_chat(message.chat.id):
            total = await client.get_chat_members_count(message.chat.id)
            username = f'@{message.chat.username}' if message.chat.username else 'Private'
            await client.send_message(LOG_CHANNEL, script.NEW_GROUP_TXT.format(message.chat.title, message.chat.id, username, total))       
            await db.add_chat(message.chat.id, message.chat.title)
        wish = get_wish()
        btn = [[
            InlineKeyboardButton('‚Ä¢ ·¥ú·¥ò·¥Ö·¥Ä·¥õ·¥ás ·¥Ñ ú·¥Ä…¥…¥·¥á ü ‚Ä¢', url=UPDATES_LINK)
        ],[
            InlineKeyboardButton('‚Ä¢ Support Group ‚Ä¢', url=SUPPORT_LINK)
        ]]
        await message.reply(text=f"<b> ú·¥á è {message.from_user.mention}, <i>{wish}</i>\n ú·¥è·¥° ·¥Ñ·¥Ä…¥ …™  ú·¥á ü·¥ò  è·¥è·¥ú??</b>", reply_markup=InlineKeyboardMarkup(btn))
        return 
        
    if not await db.is_user_exist(message.from_user.id):
        await db.add_user(message.from_user.id, message.from_user.first_name)
        await client.send_message(LOG_CHANNEL, script.NEW_USER_TXT.format(message.from_user.mention, message.from_user.id))

    verify_status = await get_verify_status(message.from_user.id)
    if verify_status['is_verified'] and VERIFY_EXPIRE < (time.time() - verify_status['verified_time']):
        await update_verify_status(message.from_user.id, is_verified=False)
    
    if (len(message.command) != 2) or (len(message.command) == 2 and message.command[1] == 'start'):
        buttons = [[
            InlineKeyboardButton('‚óà A·¥Ö·¥Ö M·¥á T·¥è Y·¥è·¥ú Ä G Ä·¥è·¥ú·¥ò ‚óà', url=f'http://t.me/{temp.U_NAME}?startgroup=true')
                ],[
                    InlineKeyboardButton('‚Ä¢ Íú±·¥ú·¥ò·¥ò·¥è Ä·¥õ ', callback_data="my_about"),
                    InlineKeyboardButton('·¥Ä ô·¥è·¥ú·¥õ ‚Ä¢', callback_data='about')
                ],[
                    InlineKeyboardButton('‚Ä¢  ú·¥á ü·¥ò', callback_data='help'),
                    InlineKeyboardButton('·¥á·¥Ä Ä…¥ ·¥ç·¥è…¥·¥á è ‚Ä¢', callback_data='earn')
                ],[
                    InlineKeyboardButton('‚Ä¢ J·¥è…™…¥ U·¥ò·¥Ö·¥Ä·¥õ·¥ás C ú·¥Ä…¥…¥·¥á ü ‚Ä¢', url=UPDATES_LINK)
                ],[
                    InlineKeyboardButton('üí≥ …¢·¥á·¥õ ·¥ò Ä·¥á·¥ç…™·¥ú·¥ç :  Ä·¥á·¥ç·¥è·¥†·¥á ·¥Ä·¥Ös üí≥', callback_data='show_plans')
                  ]]
        reply_markup = InlineKeyboardMarkup(buttons)
        m=await message.reply_sticker("CAACAgIAAxkBAAISdmW_9zmwLSbYb-Z7jGvhC_mPSB9qAAK8AAMw1J0Rd5meEIvSc6IeBA") 
        await asyncio.sleep(1)
        await m.delete()
        await message.reply_photo(
            photo=random.choice(PICS),
            caption=script.START_TXT.format(message.from_user.mention, get_wish()),
            reply_markup=reply_markup,
            parse_mode=enums.ParseMode.HTML
        )
        return

    btn = await is_subscribed(client, message) # This func is for AUTH_CHANNEL
    mc = message.command[1]
    if btn:
        if mc != 'subscribe':
            try:
                btn.append(
                    [InlineKeyboardButton("üîÅ Try Again üîÅ", callback_data=f"pm_checksub#{mc}")]
                )
            except ButtonDataInvalid:
                btn.append(
                    [InlineKeyboardButton("üîÅ Try Again üîÅ", url=f"https://t.me/{temp.U_NAME}?start={mc}")]
                )
        await message.reply_photo(
            photo=random.choice(PICS),
            caption=f"üëã Hello {message.from_user.mention},\n\nPlease join my 'Updates Channel' and request again. üòá",
            reply_markup=InlineKeyboardMarkup(btn)
        )
        return

    if mc.startswith('verify'):
        _, token = mc.split("_", 1)
        verify_status = await get_verify_status(message.from_user.id)
        if verify_status['verify_token'] != token:
            return await message.reply("Your verify token is invalid.")
        await update_verify_status(message.from_user.id, is_verified=True, verified_time=time.time())
        if verify_status["link"] == "":
            reply_markup = None
        else:
            btn = [[
                InlineKeyboardButton("üìå Get File üìå", url=f'https://t.me/{temp.U_NAME}?start={verify_status["link"]}')
            ]]
            reply_markup = InlineKeyboardMarkup(btn)
        await message.reply_photo(
            photo = "https://telegra.ph//file/14702e8bff87388acc340.jpg",
            caption = f"**‚úÖ Congratulations on Your Successful Verification! Enjoy Unlimited Access to Movies and Series!{get_readable_time(VERIFY_EXPIRE)} \n\n ‚úÖ ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤Ø‡≤∂‡≤∏‡≥ç‡≤µ‡≤ø ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤®‡≥Ü‡≤ó‡≥Ü ‡≤Ö‡≤≠‡≤ø‡≤®‡≤Ç‡≤¶‡≤®‡≥Ü‡≤ó‡≤≥‡≥Å! ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤ó‡≤≥‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤∏‡≤ø‡≤∞‡≤ø‡≤∏‡≥ç ‡≤ó‡≤≥‡≤ø‡≤ó‡≥Ü ‡≤Ö‡≤®‡≤Ç‡≤§ ‡≤™‡≥ç‡≤∞‡≤µ‡≥á‡≤∂‡≤µ‡≤®‡≥ç‡≤®‡≥Å ‡≤Ü‡≤®‡≤Ç‡≤¶‡≤ø‡≤∏‡≤ø! {get_readable_time(VERIFY_EXPIRE)} \n\n ‚úÖ ‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§™‡§∞ ‡§¨‡§ß‡§æ‡§à! ‡§´‡§ø‡§≤‡•ç‡§Æ‡•ã‡§Ç ‡§î‡§∞ ‡§∏‡•Ä‡§∞‡•Ä‡§ú ‡§ï‡§æ ‡§Ö‡§®‡§≤‡§ø‡§Æ‡§ø‡§ü‡•á‡§° ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ï‡§æ ‡§Ü‡§®‡§Ç‡§¶ ‡§≤‡•á‡§Ç! {get_readable_time(VERIFY_EXPIRE)}\n**", 
            reply_markup=reply_markup
        )
        return
    
    verify_status = await get_verify_status(message.from_user.id)
    if not await db.has_premium_access(message.from_user.id):
        if IS_VERIFY and not verify_status['is_verified']:
            token = ''.join(random.choices(string.ascii_letters + string.digits, k=10))
            await update_verify_status(message.from_user.id, verify_token=token, link="" if mc == 'inline_verify' else mc)
            loading_msg1 = await message.reply("‚è≥ ùêÇùê°ùêûùêúùê§ùê¢ùêßùê† ùê≤ùê®ùêÆùê´ ùêØùêûùê´ùê¢ùêüùê¢ùêúùêöùê≠ùê¢ùê®ùêß ùê¨ùê≠ùêöùê≠ùêÆùê¨...")
            await asyncio.sleep(0.9)
            loading_msg2 = await message.reply("üîó ùêíùêûùêßùêùùê¢ùêßùê† ùêØùêûùê´ùê¢ùêüùê¢ùêúùêöùê≠ùê¢ùê®ùêß ùê•ùê¢ùêßùê§...")
            await asyncio.sleep(1)
            await loading_msg1.delete()
            await loading_msg2.delete()
            link = await get_shortlink(SHORTLINK_URL, SHORTLINK_API, f'https://t.me/{temp.U_NAME}?start=verify_{token}')
            btn = [[
                InlineKeyboardButton("Click Here To Verify ‚úì", url=link)
            ],[
                InlineKeyboardButton('How To Verify ‚ùì', url=VERIFY_TUTORIAL)
            ]]
            await message.reply_photo(
                photo = "https://telegra.ph//file/c9f2933c392a9b3a58854.jpg",
                caption = "‚ùå You Are Not Verified For Today ! Kindly Verify Now For Access To Your Movie \n\n ‚ùå ‡≤®‡≥Ä‡≤µ‡≥Å ‡≤á‡≤Ç‡≤¶‡≤ø‡≤® ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤≤‡≥ç‡≤™‡≤°‡≤¶‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ä‡≤∞‡≤ø! ‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤à‡≤ó ‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤ö‡≤ø‡≤§‡≥ç‡≤∞‡≤ó‡≤≥‡≤ø‡≤ó‡≥Ü ‡≤™‡≥ç‡≤∞‡≤µ‡≥á‡≤∂‡≤ø‡≤∏‡≤≤‡≥Å ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤ø \n\n ‚ùå ‡§Ü‡§™ ‡§Ü‡§ú ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç! ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§¨ ‡§Ö‡§™‡§®‡•Ä ‡§Æ‡•Ç‡§µ‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç\n",
                reply_markup=InlineKeyboardMarkup(btn)                
            )
            return
 
    if mc.startswith('all'):
        type_, grp_id, key = mc.split("_", 2)
        files = temp.FILES.get(key)
        if not files:
            return await message.reply('No Such All Files Exist!')
        settings = await get_settings(int(grp_id))
        if not await db.has_premium_access(message.from_user.id):            
            if type_ != 'all-file' and settings['shortlink']:
                link = await get_shortlink(settings['url'], settings['api'], f"https://t.me/{temp.U_NAME}?start=all-file_{grp_id}_{key}")
                btn = [[
                    InlineKeyboardButton("‚ôªÔ∏è Get File ‚ôªÔ∏è", url=link)
                ],[
                    InlineKeyboardButton("üìç  ú·¥è·¥° ·¥õ·¥è ·¥è·¥ò·¥á…¥  ü…™…¥·¥ã üìç", url=settings['tutorial'])
                ]]
                await message.reply(f"ALL Your File Is Ready, Please Get Using This Link. üëç", reply_markup=InlineKeyboardMarkup(btn), protect_content=True)
                return
            else:
                pass 
        for file in files:
            CAPTION = settings['caption']
            f_caption = CAPTION.format(
                file_name = file.file_name,
                file_size = get_size(file.file_size),
                file_caption=file.caption
            )   
            btn = [[
                InlineKeyboardButton("·¥°·¥Ä·¥õ·¥Ñ ú ·¥è…¥ ü…™…¥·¥á üëÄ / Íú∞·¥Äs·¥õ ·¥Ö·¥è·¥°…¥ ü·¥è·¥Ä·¥Ö üóÇÔ∏è", callback_data="stream_button")
            ],[
                InlineKeyboardButton('‚ÅâÔ∏è ·¥Ñ ü·¥ès·¥á ‚ÅâÔ∏è', callback_data='close_data')
            ]]
            await client.send_cached_media(
                chat_id=message.from_user.id,
                file_id=file.file_id,
                caption=f_caption,
                protect_content=settings['file_secure'],
                reply_markup=InlineKeyboardMarkup(btn)
            )
        return

    type_, grp_id, file_id = mc.split("_", 2)
    files_ = await get_file_details(file_id)
    if not files_:
        return await message.reply('No Such File Exist!')
    files = files_[0]
    settings = await get_settings(int(grp_id))
    if not await db.has_premium_access(message.from_user.id):        
        if type_ != 'shortlink' and settings['shortlink']:
            link = await get_shortlink(settings['url'], settings['api'], f"https://t.me/{temp.U_NAME}?start=shortlink_{grp_id}_{file_id}")
            btn = [[
                InlineKeyboardButton("‚ôªÔ∏è  è·¥è·¥ú Ä Íú∞…™ ü·¥á ‚ôªÔ∏è", url=link)
            ],[
                InlineKeyboardButton("‚ùì  ú·¥è·¥° ·¥õ·¥è ·¥è·¥ò·¥á…¥  ü…™…¥·¥ã ‚ùì", url=settings['tutorial'])
            ]]
            await message.reply(f"**[{get_size(files.file_size)}] {files.file_name}**\n\n**ùöàùöòùöûùöõ ùôµùöíùöïùöé ùô∏ùöú ùöÅùöéùöäùöçùö¢, ùôøùöïùöéùöäùöúùöé ùô∂ùöéùöù ùöÑùöúùöíùöóùöê ùöÉùöëùöíùöú ùôªùöíùöóùöî.** üëç", reply_markup=InlineKeyboardMarkup(btn), protect_content=True)
            return            
        else:
            pass
    CAPTION = settings['caption']
    f_caption = CAPTION.format(
        file_name = files.file_name,
        file_size = get_size(files.file_size),
        file_caption=files.caption
    )
    btn = [[
        InlineKeyboardButton("·¥°·¥Ä·¥õ·¥Ñ ú ·¥è…¥ ü…™…¥·¥á üëÄ / Íú∞·¥Äs·¥õ ·¥Ö·¥è·¥°…¥ ü·¥è·¥Ä·¥Ö üóÇÔ∏è", callback_data="stream_button")
    ],[
        InlineKeyboardButton('‚ÅâÔ∏è ·¥Ñ ü·¥ès·¥á ‚ÅâÔ∏è', callback_data='close_data')
    ]]
    await client.send_cached_media(
        chat_id=message.from_user.id,
        file_id=file_id,
        caption=f_caption,
        protect_content=settings['file_secure'],
        reply_markup=InlineKeyboardMarkup(btn)
    )

@Client.on_message(filters.command('index_channels') & filters.user(ADMINS))
async def channels_info(bot, message):
    """Send basic information of index channels"""
    ids = INDEX_CHANNELS
    if not ids:
        return await message.reply("Not set INDEX_CHANNELS")

    text = '**Indexed Channels:**\n\n'
    for id in ids:
        chat = await bot.get_chat(id)
        text += f'{chat.title}\n'
    text += f'\n**Total:** {len(ids)}'
    await message.reply(text)

@Client.on_message(filters.command('stats') & filters.user(ADMINS))
async def stats(bot, message):
    msg = await message.reply('Please Wait...')
    files = await Media.count_documents()
    users = await db.total_users_count()
    chats = await db.total_chat_count()
    size = await db.get_db_size()
    free = 536870912 - size
    uptime = get_readable_time(time.time() - temp.START_TIME)
    size = get_size(size)
    free = get_size(free)
    await msg.edit(script.STATUS_TXT.format(files, users, chats, size, free, uptime))    
    
@Client.on_message(filters.command('settings'))
async def settings(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type == enums.ChatType.PRIVATE:
        grpid = await active_connection(str(userid))
        if grpid is not None:
            grp_id = grpid
            if not await is_check_admin(client, grp_id, message.from_user.id):             
                return await message.reply_text('You not admin in this group.')
            try:
                chat = await client.get_chat(grpid)
                title = chat.title
            except:
                await message.reply_text("Make sure I'm present in your group!!", quote=True)
                return
        else:
            await message.reply_text("I'm not connected to any groups!", quote=True)
            return


    elif chat_type in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:               
        grp_id = message.chat.id
        if not await is_check_admin(client, grp_id, message.from_user.id):
            return await message.reply_text('You not admin in this group.')
    settings = await get_settings(grp_id)
    if settings is not None:
        buttons = [[
            InlineKeyboardButton('Auto Filter', callback_data=f'setgs#auto_filter#{settings["auto_filter"]}#{grp_id}'),
            InlineKeyboardButton('‚úÖ Yes' if settings["auto_filter"] else '‚ùå No', callback_data=f'setgs#auto_filter#{settings["auto_filter"]}#{grp_id}')
        ],[
            InlineKeyboardButton('File Secure', callback_data=f'setgs#file_secure#{settings["file_secure"]}#{grp_id}'),
            InlineKeyboardButton('‚úÖ Yes' if settings["file_secure"] else '‚ùå No', callback_data=f'setgs#file_secure#{settings["file_secure"]}#{grp_id}')
        ],[
            InlineKeyboardButton('IMDb Poster', callback_data=f'setgs#imdb#{settings["imdb"]}#{grp_id}'),
            InlineKeyboardButton('‚úÖ Yes' if settings["imdb"] else '‚ùå No', callback_data=f'setgs#imdb#{settings["imdb"]}#{grp_id}')
        ],[
            InlineKeyboardButton('Spelling Check', callback_data=f'setgs#spell_check#{settings["spell_check"]}#{grp_id}'),
            InlineKeyboardButton('‚úÖ Yes' if settings["spell_check"] else '‚ùå No', callback_data=f'setgs#spell_check#{settings["spell_check"]}#{grp_id}')
        ],[
            InlineKeyboardButton('Auto Delete', callback_data=f'setgs#auto_delete#{settings["auto_delete"]}#{grp_id}'),
            InlineKeyboardButton(f'{get_readable_time(DELETE_TIME)}' if settings["auto_delete"] else '‚ùå No', callback_data=f'setgs#auto_delete#{settings["auto_delete"]}#{grp_id}')
        ],[
            InlineKeyboardButton('Welcome', callback_data=f'setgs#welcome#{settings["welcome"]}#{grp_id}',),
            InlineKeyboardButton('‚úÖ Yes' if settings["welcome"] else '‚ùå No', callback_data=f'setgs#welcome#{settings["welcome"]}#{grp_id}'),
        ],[
            InlineKeyboardButton('Shortlink', callback_data=f'setgs#shortlink#{settings["shortlink"]}#{grp_id}'),
            InlineKeyboardButton('‚úÖ Yes' if settings["shortlink"] else '‚ùå No', callback_data=f'setgs#shortlink#{settings["shortlink"]}#{grp_id}'),
        ],[
            InlineKeyboardButton('Result Page', callback_data=f'setgs#links#{settings["links"]}#{str(grp_id)}'),
            InlineKeyboardButton('‚õì Link' if settings["links"] else 'üß≤ Button', callback_data=f'setgs#links#{settings["links"]}#{str(grp_id)}')
        ],[
            InlineKeyboardButton('‚ùå Close ‚ùå', callback_data='close_data')
        ]]
        await message.reply_text(
            text=f"Change your settings for <b>'{message.chat.title}'</b> as your wish. ‚öô",
            reply_markup=InlineKeyboardMarkup(buttons),
            parse_mode=enums.ParseMode.HTML
        )
    else:
        await message.reply_text('Something went wrong!')

@Client.on_message(filters.command('set_template'))
async def save_template(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type not in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        return await message.reply_text("Use this command in group.")      
    grp_id = message.chat.id
    title = message.chat.title
    if not await is_check_admin(client, grp_id, message.from_user.id):
        return await message.reply_text('You not admin in this group.')
    try:
        template = message.text.split(" ", 1)[1]
    except:
        return await message.reply_text("Command Incomplete!")   
    await save_group_settings(grp_id, 'template', template)
    await message.reply_text(f"Successfully changed template for {title} to\n\n{template}")  
    
@Client.on_message(filters.command('set_caption'))
async def save_caption(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type not in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        return await message.reply_text("Use this command in group.")      
    grp_id = message.chat.id
    title = message.chat.title
    if not await is_check_admin(client, grp_id, message.from_user.id):
        return await message.reply_text('You not admin in this group.')
    try:
        caption = message.text.split(" ", 1)[1]
    except:
        return await message.reply_text("Command Incomplete!") 
    await save_group_settings(grp_id, 'caption', caption)
    await message.reply_text(f"Successfully changed caption for {title} to\n\n{caption}")
        
@Client.on_message(filters.command('set_shortlink'))
async def save_shortlink(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type not in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        return await message.reply_text("Use this command in group.")    
    grp_id = message.chat.id
    title = message.chat.title
    if not await is_check_admin(client, grp_id, message.from_user.id):
        return await message.reply_text('You not admin in this group.')
    try:
        _, url, api = message.text.split(" ", 2)
    except:
        return await message.reply_text("<b>Command Incomplete:-\n\ngive me a shortlink & api along with the command...\n\nEx:- <code>/shortlink mdisklink.link 5843c3cc645f5077b2200a2c77e0344879880b3e</code>")   
    try:
        await get_shortlink(url, api, f'https://t.me/{temp.U_NAME}')
    except:
        return await message.reply_text("Your shortlink API or URL invalid, Please Check again!")   
    await save_group_settings(grp_id, 'url', url)
    await save_group_settings(grp_id, 'api', api)
    await message.reply_text(f"Successfully changed shortlink for {title} to\n\nURL - {url}\nAPI - {api}")
    
@Client.on_message(filters.command('get_custom_settings'))
async def get_custom_settings(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type not in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        return await message.reply_text("Use this command in group.")
    grp_id = message.chat.id
    title = message.chat.title
    if not await is_check_admin(client, grp_id, message.from_user.id):
        return await message.reply_text('You not admin in this group...')    
    settings = await get_settings(grp_id)
    text = f"""Custom settings for: {title}

Shortlink URL: {settings["url"]}
Shortlink API: {settings["api"]}

IMDb Template: {settings['template']}

File Caption: {settings['caption']}

Welcome Text: {settings['welcome_text']}

Tutorial Link: {settings['tutorial']}

Force Channels: {str(settings['fsub'])[1:-1] if settings['fsub'] else 'Not Set'}"""

    btn = [[
        InlineKeyboardButton(text="Close", callback_data="close_data")
    ]]
    await message.reply_text(text, reply_markup=InlineKeyboardMarkup(btn), disable_web_page_preview=True)

@Client.on_message(filters.command('set_welcome'))
async def save_welcome(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type not in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        return await message.reply_text("Use this command in group.")      
    grp_id = message.chat.id
    title = message.chat.title
    if not await is_check_admin(client, grp_id, message.from_user.id):
        return await message.reply_text('You not admin in this group.')
    try:
        welcome = message.text.split(" ", 1)[1]
    except:
        return await message.reply_text("Command Incomplete!")    
    await save_group_settings(grp_id, 'welcome_text', welcome)
    await message.reply_text(f"Successfully changed welcome for {title} to\n\n{welcome}")
        
@Client.on_message(filters.command('delete') & filters.user(ADMINS))
async def delete_file(bot, message):
    try:
        query = message.text.split(" ", 1)[1]
    except:
        return await message.reply_text("Command Incomplete!\nUsage: /delete query")
    msg = await message.reply_text('Searching...')
    total, files = await delete_files(query)
    if int(total) == 0:
        return await msg.edit('Not have files in your query')
    btn = [[
        InlineKeyboardButton("YES", callback_data=f"delete_{query}")
    ],[
        InlineKeyboardButton("CLOSE", callback_data="close_data")
    ]]
    await msg.edit(f"Total {total} files found in your query {query}.\n\nDo you want to delete?", reply_markup=InlineKeyboardMarkup(btn))
 
@Client.on_message(filters.command('delete_all') & filters.user(ADMINS))
async def delete_all_index(bot, message):
    btn = [[
        InlineKeyboardButton(text="YES", callback_data="delete_all")
    ],[
        InlineKeyboardButton(text="CLOSE", callback_data="close_data")
    ]]
    files = await Media.count_documents()
    if int(files) == 0:
        return await message.reply_text('Not have files to delete')
    await message.reply_text(f'Total {files} files have.\nDo you want to delete all?', reply_markup=InlineKeyboardMarkup(btn))

@Client.on_message(filters.command('set_tutorial'))
async def set_tutorial(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type not in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        return await message.reply_text("Use this command in group.")       
    grp_id = message.chat.id
    title = message.chat.title
    if not await is_check_admin(client, grp_id, message.from_user.id):
        return await message.reply_text('You not admin in this group.')
    try:
        tutorial = message.text.split(" ", 1)[1]
    except:
        return await message.reply_text("Command Incomplete!")   
    await save_group_settings(grp_id, 'tutorial', tutorial)
    await message.reply_text(f"Successfully changed tutorial for {title} to\n\n{tutorial}")

@Client.on_message(filters.command('set_fsub'))
async def set_fsub(client, message):
    userid = message.from_user.id if message.from_user else None
    if not userid:
        return await message.reply("<b>You are Anonymous admin you can't use this command !</b>")
    chat_type = message.chat.type
    if chat_type not in [enums.ChatType.GROUP, enums.ChatType.SUPERGROUP]:
        return await message.reply_text("Use this command in group.")      
    grp_id = message.chat.id
    title = message.chat.title
    if not await is_check_admin(client, grp_id, message.from_user.id):
        return await message.reply_text('You not admin in this group.')
    try:
        ids = message.text.split(" ", 1)[1]
        fsub_ids = list(map(int, ids.split()))
    except IndexError:
        return await message.reply_text("Command Incomplete!\n\nCan multiple channel add separate by spaces. Like: /set_fsub id1 id2 id3")
    except ValueError:
        return await message.reply_text('Make sure ids is integer.')        
    channels = "Channels:\n"
    for id in fsub_ids:
        try:
            chat = await client.get_chat(id)
        except Exception as e:
            return await message.reply_text(f"{id} is invalid!\nMake sure this bot admin in that channel.\n\nError - {e}")
        if chat.type != enums.ChatType.CHANNEL:
            return await message.reply_text(f"{id} is not channel.")
        channels += f'{chat.title}\n'
        if not await db.has_premium_access(message.from_user.id):
            await message.reply_text("<b>You don't have access to use this command!buy premium ship check /plans</b>")
            return
        else:
            pass
    await save_group_settings(grp_id, 'fsub', fsub_ids)
    await message.reply_text(f"Successfully set force channels for {title} to\n\n{channels}")

@Client.on_message(filters.command('telegraph'))
async def telegraph(bot, message):
    reply_to_message = message.reply_to_message
    if not reply_to_message:
        return await message.reply('Reply to any photo or video.')
    file = reply_to_message.photo or reply_to_message.video or None
    if file is None:
        return await message.reply('Invalid media.')
    if file.file_size >= 5242880:
        await message.reply_text(text="Send less than 5MB")   
        return
    text = await message.reply_text(text="·¥ò Ä·¥è·¥Ñ·¥áss…™…¥…¢....")   
    media = await reply_to_message.download()  
    try:
        response = upload_file(media)
    except Exception as e:
        await text.edit_text(text=f"Error - {e}")
        return    
    try:
        os.remove(media)
    except:
        pass
    await text.edit_text(f"<b>‚ù§Ô∏è  è·¥è·¥ú Ä ·¥õ·¥á ü·¥á…¢ Ä·¥Ä·¥ò ú  ü…™…¥·¥ã ·¥Ñ·¥è·¥ç·¥ò ü·¥á·¥õ·¥á·¥Ö üëá</b>\n\n<code>https://telegra.ph/{response[0]}</code></b>")

@Client.on_message(filters.command('ping'))
async def ping(client, message):
    start_time = time.monotonic()
    msg = await message.reply("üëÄ")
    end_time = time.monotonic()
    await msg.edit(f'{round((end_time - start_time) * 1000)} ms')

@Client.on_message(filters.command("add_premium") & filters.user(ADMINS))
async def give_premium_cmd_handler(client, message):
    if len(message.command) == 3:
        try:
            user_id = int(message.command[1])  # Convert the user_id to an integer
            time_str = message.command[2]
            seconds = await get_seconds(time_str)
            if seconds > 0:
                expiry_time = datetime.datetime.now() + datetime.timedelta(seconds=seconds)
                user_data = {"id": user_id, "expiry_time": expiry_time}  # Using "id" instead of "user_id"
                await db.update_user(user_data)  # Use the update_user method to update or insert user data
                
                # Create an inline keyboard with a button
                keyboard = InlineKeyboardMarkup(inline_keyboard=[
                    [ 
                         InlineKeyboardButton(text="‚Ä¢ ·¥ç·¥è·¥†…™·¥á  Ä·¥á«´·¥ú·¥áÍú±·¥õ …¢ Ä·¥è·¥ú·¥ò ‚Ä¢", url="https://t.me/+o_VcAI8GRQ8zYzA9")
                    ],[
                         InlineKeyboardButton(text="‚Ä¢ S·¥ú·¥ò·¥ò·¥è Ä·¥õ G Ä·¥è·¥ú·¥ò ‚Ä¢", url="https://t.me/filmyspot_support")
                    ]
                        ])
                # Send the message with the inline keyboard
                await client.send_message(
                    chat_id=user_id,
                    text=f"<b>ùêèùê´ùêûùê¶ùê¢ùêÆùê¶ ùêöùêùùêùùêûùêù ùê≠ùê® ùê≤ùê®ùêÆùê´ ùêöùêúùêúùê®ùêÆùêßùê≠ ùêüùê®ùê´ {time_str} üåü. ùêÑùêßùê£ùê®ùê≤ ùê≤ùê®ùêÆùê´ ùêûùê±ùêúùê•ùêÆùê¨ùê¢ùêØùêû ùêöùêúùêúùêûùê¨ùê¨ ùê≠ùê® ùê®ùêÆùê´ ùê¶ùê®ùêØùê¢ùêû ùêúùê®ùê•ùê•ùêûùêúùê≠ùê¢ùê®ùêß!\n</b>",
                    reply_markup=keyboard
                )
                
                await message.reply_text("Premium access added to the user.")
            else:
                await message.reply_text("Invalid time format. Please use '1day for days', '1hour for hours', '1min for minutes', '1month for months', or '1year for year'")
        except ValueError:
            await message.reply_text("Invalid user ID. Please provide a valid user ID.")
        except Exception as e:
            await message.reply_text(f"An error occurred: {str(e)}")
    else:
        await message.reply_text("Usage: /add_premium user_id time (e.g., '1day for days', '1hour for hours', '1min for minutes', '1month for months', or '1year for year')")
            
        
@Client.on_message(filters.command("remove_premium") & filters.user(ADMINS))
async def remove_premium_cmd_handler(client, message):
    if len(message.command) == 2:
        user_id = int(message.command[1])  # Convert the user_id to integer
      #  time = message.command[2]
        time = "1s"
        seconds = await get_seconds(time)
        if seconds > 0:
            expiry_time = datetime.datetime.now() + datetime.timedelta(seconds=seconds)
            user_data = {"id": user_id, "expiry_time": expiry_time}  # Using "id" instead of "user_id"
            await db.update_user(user_data)  # Use the update_user method to update or insert user data
            await message.reply_text("Premium access removed to the user.")
            await client.send_message(
                chat_id=user_id,
                text=f"<b>premium removed by admins \n\n Contact Admin if this is mistake \n\n üëÆ Admin : @Rk_botowner \n</b>",                
            )
        else:
            await message.reply_text("Invalid time format.'")
    else:
        await message.reply_text("Usage: /remove_premium user_id")
        
@Client.on_message(filters.command("plans"))
async def plans_cmd_handler(client, message):                
    btn = [   
        [InlineKeyboardButton("üÜô ·¥Ñ ü…™·¥Ñ·¥ã ·¥õ·¥è  ô·¥ú è üÜô", url="https://cosmofeed.com/vig/65ae01464009dd001dc656d8")],         
        [InlineKeyboardButton("‚ö†Ô∏è·¥Ñ ü·¥ès·¥á / ·¥Ö·¥á ü·¥á·¥õ·¥á‚ö†Ô∏è", callback_data="close_data")]
    ]
    reply_markup = InlineKeyboardMarkup(btn)
    await message.reply_photo(
        photo="https://graph.org/file/775165057a97fb4393a80.jpg",
        caption="‚Äª‚îÄ‚îÄ[ üî• ·¥Ä·¥†·¥Ä…™ ü·¥Ä ô ü·¥á ·¥ò ü·¥Ä…¥s üî• ]‚îÄ‚îÄ‚Äª\n‚îÇ‚áõ ‚Çπ15 -  1 W·¥á·¥á·¥ã\n‚îÇ‚áõ ‚Çπ39 -  1 M·¥è…¥·¥õ ú\n‚îÇ‚áõ ‚Çπ69 -  2 M·¥è…¥·¥õ ús\n‚îÇ‚áõ ‚Çπ99 -  3 M·¥è…¥·¥õ ús\n‚îÇ‚áõ ‚Çπ179 - 6 M·¥è…¥·¥õ ús\n‚îÇ‚áõ ‚Çπ299 - 1 Y·¥á·¥Ä Ä\n‚îÇ‚áõ Custom Plan - Contact Owner\n‚Äª‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Äª\n\n‚ï≠‚îÄ‚îÄüéÅ ·¥ò Ä·¥á·¥ç…™·¥ú·¥ç “ì·¥á·¥Ä·¥õ·¥ú Ä·¥ás üéÅ‚îÄ‚îÄ‚ïÆ\n‚îÇ ‚Ä¢ …¥·¥è …¥·¥á·¥á·¥Ö ·¥õ·¥è ·¥†·¥á Ä…™“ì è\n‚îÇ ‚Ä¢ ·¥Ö…™ Ä·¥á·¥Ñ·¥õ “ì…™ ü·¥ás\n‚îÇ ‚Ä¢ ·¥Ä·¥Ö-“ì Ä·¥á·¥á ·¥áx·¥ò·¥á Ä…™·¥á…¥·¥Ñ·¥á\n‚îÇ ‚Ä¢  ú…™…¢ ú-s·¥ò·¥á·¥á·¥Ö ·¥Ö·¥è·¥°…¥ ü·¥è·¥Ä·¥Ö  ü…™…¥·¥ã\n‚îÇ ‚Ä¢ ·¥ç·¥ú ü·¥õ…™-·¥ò ü·¥Ä è·¥á Ä s·¥õ Ä·¥á·¥Ä·¥ç…™…¥…¢  ü…™…¥·¥ãs\n‚îÇ ‚Ä¢ ·¥ú…¥ ü…™·¥ç…™·¥õ·¥á·¥Ö ·¥ç·¥è·¥†…™·¥ás & s·¥á Ä…™·¥ás\n‚îÇ ‚Ä¢  ú…™…¢ ú «´·¥ú·¥Ä ü…™·¥õ è ·¥Ä·¥†·¥Ä…™ ü·¥Ä ô ü·¥á\n‚îÇ ‚Ä¢ Íú∞·¥ú ü ü ·¥Ä·¥Ö·¥ç…™…¥ s·¥ú·¥ò·¥ò·¥è Ä·¥õ\n‚îÇ ‚Ä¢  Ä·¥á«´·¥ú·¥ás·¥õ ·¥°…™ ü ü  ô·¥á ·¥Ñ·¥è·¥ç·¥ò ü·¥á·¥õ·¥á·¥Ö …™…¥ 1  ú·¥è·¥ú Ä …™Íú∞ ·¥Ä·¥†·¥Ä…™ ü·¥Ä ô ü·¥á\n‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ\n\nùêÅùêîùêò ùêçùêéùêñ ‚û¢ [üÖ≤üÖªüÖ∏üÖ≤üÖ∫ üÖ∑üÖ¥üÜÅüÖ¥](https://cosmofeed.com/vig/65ae01464009dd001dc656d8)\n\n‚û• I“ì  è·¥è·¥ú' Ä·¥á …¥·¥è·¥õ Íú±·¥ú Ä·¥á  ú·¥è·¥° ·¥õ·¥è  ô·¥ú è, …™·¥úÍú±·¥õ ·¥°·¥Ä·¥õ·¥Ñ ú ·¥õ ú·¥á ·¥õ·¥ú·¥õ·¥è Ä…™·¥Ä ü. /plantutorial\n\n‚û• ·¥Ñ ú·¥á·¥Ñ·¥ã  è·¥è·¥ú Ä ·¥Ä·¥Ñ·¥õ…™·¥†·¥á ·¥ò ü·¥Ä…¥ /myplan\n\n‚û• ·¥ç·¥ús·¥õ s·¥á…¥·¥Ö s·¥Ñ Ä·¥á·¥á…¥s ú·¥è·¥õ ·¥Ä“ì·¥õ·¥á Ä ·¥ò·¥Ä è·¥ç·¥á…¥·¥õ\n\n‚ö†Ô∏è ùêèùê•ùêûùêöùê¨ùêû ùêöùê•ùê•ùê®ùê∞ ùê¨ùê®ùê¶ùêû ùê≠ùê¢ùê¶ùêû ùêöùêüùê≠ùêûùê´ ùê¨ùêûùêßùêùùê¢ùêßùê† ùê≠ùê°ùêû ùê¨ùêúùê´ùêûùêûùêßùê¨ùê°ùê®ùê≠ ùêüùê®ùê´ ùê≠ùê°ùêû ùê©ùê´ùêûùê¶ùê¢ùêÆùê¶ ùêöùêúùêúùêûùê¨ùê¨ ùê≠ùê® ùê≠ùêöùê§ùêû ùêûùêüùêüùêûùêúùê≠.",
        reply_markup=reply_markup
    )
        
@Client.on_message(filters.command("my_plan"))
async def check_plans_cmd(client, message):
    user_id  = message.from_user.id
    if await db.has_premium_access(user_id):         
        remaining_time = await db.check_remaining_uasge(user_id)             
        expiry_time = remaining_time + datetime.datetime.now()
        await message.reply_text(f"**Your plans details are :\n\nRemaining Time : {remaining_time}\n\nExpirytime : {expiry_time}**")
    else:
        btn = [                                
            [InlineKeyboardButton(" ô·¥ú è s·¥ú ôs·¥Ñ Ä…™·¥ò·¥õ…™·¥è…¥ :  Ä·¥á·¥ç·¥è·¥†·¥á ·¥Ä·¥Ös", callback_data="buy_premium")],
            [InlineKeyboardButton("‚ö†Ô∏è ·¥Ñ ü·¥ès·¥á / ·¥Ö·¥á ü·¥á·¥õ·¥á ‚ö†Ô∏è", callback_data="close_data")]
        ]
        reply_markup = InlineKeyboardMarkup(btn)
        m=await message.reply_sticker("CAACAgIAAxkBAAIBTGVjQbHuhOiboQsDm35brLGyLQ28AAJ-GgACglXYSXgCrotQHjibHgQ")         
        await message.reply_text(f"**üò¢ You Don't Have Any Premium Subscription.\n\n Check Out Our Premium /plans**",reply_markup=reply_markup)
        await asyncio.sleep(2)
        await m.delete()

@Client.on_callback_query(filters.regex("show_plans"))
async def show_plans_callback_handler(client, callback_query):
    # Send the plans message using the logic from the plans command
    btn = [   
        [InlineKeyboardButton("‚Ä¢ …¢·¥á·¥õ ùüª ·¥ç…™…¥ “ì Ä·¥á·¥á ·¥õ Ä…™·¥Ä ü ‚Ä¢", callback_data="get_trail")],
        [InlineKeyboardButton("üÜô ·¥Ñ ü…™·¥Ñ·¥ã ·¥õ·¥è  ô·¥ú è üÜô", url="https://cosmofeed.com/vig/65ae01464009dd001dc656d8")],         
        [InlineKeyboardButton("‚ö†Ô∏è·¥Ñ ü·¥ès·¥á / ·¥Ö·¥á ü·¥á·¥õ·¥á‚ö†Ô∏è", callback_data="close_data")]
    ]
    reply_markup = InlineKeyboardMarkup(btn)
    await callback_query.message.reply_photo(
        photo="https://graph.org/file/775165057a97fb4393a80.jpg",
        caption="‚Äª‚îÄ‚îÄ[ üî• ·¥Ä·¥†·¥Ä…™ ü·¥Ä ô ü·¥á ·¥ò ü·¥Ä…¥s üî• ]‚îÄ‚îÄ‚Äª\n‚îÇ‚áõ ‚Çπ15 -  1 W·¥á·¥á·¥ã\n‚îÇ‚áõ ‚Çπ39 -  1 M·¥è…¥·¥õ ú\n‚îÇ‚áõ ‚Çπ69 -  2 M·¥è…¥·¥õ ús\n‚îÇ‚áõ ‚Çπ99 -  3 M·¥è…¥·¥õ ús\n‚îÇ‚áõ ‚Çπ179 - 6 M·¥è…¥·¥õ ús\n‚îÇ‚áõ ‚Çπ299 - 1 Y·¥á·¥Ä Ä\n‚îÇ‚áõ Custom Plan - Contact Owner\n‚Äª‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Äª\n\n‚ï≠‚îÄ‚îÄüéÅ ·¥ò Ä·¥á·¥ç…™·¥ú·¥ç “ì·¥á·¥Ä·¥õ·¥ú Ä·¥ás üéÅ‚îÄ‚îÄ‚ïÆ\n‚îÇ ‚Ä¢ …¥·¥è …¥·¥á·¥á·¥Ö ·¥õ·¥è ·¥†·¥á Ä…™“ì è\n‚îÇ ‚Ä¢ ·¥Ö…™ Ä·¥á·¥Ñ·¥õ “ì…™ ü·¥ás\n‚îÇ ‚Ä¢ ·¥Ä·¥Ö-“ì Ä·¥á·¥á ·¥áx·¥ò·¥á Ä…™·¥á…¥·¥Ñ·¥á\n‚îÇ ‚Ä¢  ú…™…¢ ú-s·¥ò·¥á·¥á·¥Ö ·¥Ö·¥è·¥°…¥ ü·¥è·¥Ä·¥Ö  ü…™…¥·¥ã\n‚îÇ ‚Ä¢ ·¥ç·¥ú ü·¥õ…™-·¥ò ü·¥Ä è·¥á Ä s·¥õ Ä·¥á·¥Ä·¥ç…™…¥…¢  ü…™…¥·¥ãs\n‚îÇ ‚Ä¢ ·¥ú…¥ ü…™·¥ç…™·¥õ·¥á·¥Ö ·¥ç·¥è·¥†…™·¥ás & s·¥á Ä…™·¥ás\n‚îÇ ‚Ä¢  ú…™…¢ ú «´·¥ú·¥Ä ü…™·¥õ è ·¥Ä·¥†·¥Ä…™ ü·¥Ä ô ü·¥á\n‚îÇ ‚Ä¢ Íú∞·¥ú ü ü ·¥Ä·¥Ö·¥ç…™…¥ s·¥ú·¥ò·¥ò·¥è Ä·¥õ\n‚îÇ ‚Ä¢  Ä·¥á«´·¥ú·¥ás·¥õ ·¥°…™ ü ü  ô·¥á ·¥Ñ·¥è·¥ç·¥ò ü·¥á·¥õ·¥á·¥Ö …™…¥ 1  ú·¥è·¥ú Ä …™Íú∞ ·¥Ä·¥†·¥Ä…™ ü·¥Ä ô ü·¥á\n‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ\n\nùêÅùêîùêò ùêçùêéùêñ ‚û¢ [üÖ≤üÖªüÖ∏üÖ≤üÖ∫ üÖ∑üÖ¥üÜÅüÖ¥](https://cosmofeed.com/vig/65ae01464009dd001dc656d8)\n\n‚û• I“ì  è·¥è·¥ú' Ä·¥á …¥·¥è·¥õ Íú±·¥ú Ä·¥á  ú·¥è·¥° ·¥õ·¥è  ô·¥ú è, …™·¥úÍú±·¥õ ·¥°·¥Ä·¥õ·¥Ñ ú ·¥õ ú·¥á ·¥õ·¥ú·¥õ·¥è Ä…™·¥Ä ü. /plantutorial\n\n‚û• ·¥Ñ ú·¥á·¥Ñ·¥ã  è·¥è·¥ú Ä ·¥Ä·¥Ñ·¥õ…™·¥†·¥á ·¥ò ü·¥Ä…¥ /my_plan\n\n‚û• ·¥ç·¥ús·¥õ s·¥á…¥·¥Ö s·¥Ñ Ä·¥á·¥á…¥s ú·¥è·¥õ ·¥Ä“ì·¥õ·¥á Ä ·¥ò·¥Ä è·¥ç·¥á…¥·¥õ\n\n‚ö†Ô∏è ùêèùê•ùêûùêöùê¨ùêû ùêöùê•ùê•ùê®ùê∞ ùê¨ùê®ùê¶ùêû ùê≠ùê¢ùê¶ùêû ùêöùêüùê≠ùêûùê´ ùê¨ùêûùêßùêùùê¢ùêßùê† ùê≠ùê°ùêû ùê¨ùêúùê´ùêûùêûùêßùê¨ùê°ùê®ùê≠ ùêüùê®ùê´ ùê≠ùê°ùêû ùê©ùê´ùêûùê¶ùê¢ùêÆùê¶ ùêöùêúùêúùêûùê¨ùê¨ ùê≠ùê® ùê≠ùêöùê§ùêû ùêûùêüùêüùêûùêúùê≠.",
        reply_markup=reply_markup
    )

@Client.on_message(filters.command("shortener_list"))
async def shortener_list_handler(client, message):
    # Define the inline keyboard buttons
    buttons = [
        [
            InlineKeyboardButton("üìû ·¥Ñ·¥è…¥·¥õ·¥Ä·¥Ñ·¥õ ", url="t.me/FilmySpotSupport_bot"),
            InlineKeyboardButton("·¥Ö·¥á ü·¥á·¥õ·¥á", callback_data="close_data")
        ]
    ]
    # Create an InlineKeyboardMarkup object with the buttons
    reply_markup = InlineKeyboardMarkup(buttons)
    # Send the photo with the caption and inline keyboard markup
    await message.reply_text(
        text="‚ï≠‚îÅ‚îÅ‚îÅ‚ù∞ ùó∂ùóªùòÄùòÅùóÆùóªùòÅùó≤ùóÆùóøùóª ‚ù±‚îÅ‚îÅ‚îÅ‚òÜ\n‚î£‚™ºüìÑ ùó£ùóÆùó¥ùó≤ùòÄ: ùü∞\n‚î£‚™ºüíµ ùóôùó∂ùòÖùó≤ùó± ùóñùó£ùó†: $ùü≠ùü¨ / ‚Çπùü¥ùü¨ùü¨\n‚î£‚™ºüí≥ ùó™ùó∂ùòÅùóµùó±ùóøùóÆùòÑùóÆùóπ: $ùüÆ / ‚Çπùü≠ùü≤ùü¨\n‚î£‚™ºüåê ùó•ùó≤ùó≥ùó≤ùóøùóøùóÆùóπ ùóüùó∂ùóªùó∏: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](https://bit.ly/instantearn0)\n‚î£‚™ºüìé ùóóùó≤ùó∫ùóº ùóüùó∂ùóªùó∏: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](http://instantearn.in/instantearn)\n‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚òÜ\n\n‚ï≠‚îÅ‚îÅ‚îÅ‚ù∞ ùóºùóªùó≤ùóΩùóÆùó¥ùó≤ùóπùó∂ùóªùó∏ ‚ù±‚îÅ‚îÅ‚îÅ‚òÜ\n‚î£‚™ºüìÑ ùó£ùóÆùó¥ùó≤ùòÄ: ùü≠\n‚î£‚™ºüíµ ùóîùòÉùó≤ùóøùóÆùó¥ùó≤ ùóñùó£ùó†: ‚ÇπùüÆùü±ùü¨\n‚î£‚™ºüí≥ ùó™ùó∂ùòÅùóµùó±ùóøùóÆùòÑùóÆùóπ: $ùüÆ.ùü∞ùü≠ / ‚ÇπùüÆùü¨ùü¨\n‚î£‚™ºüåê ùó•ùó≤ùó≥ùó≤ùóøùóøùóÆùóπ ùóüùó∂ùóªùó∏: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](https://bit.ly/onepagelink)\n‚î£‚™ºüìé ùóóùó≤ùó∫ùóº: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](http://onepagelink.in/onepagelink)\n‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚òÜ\n\n‚ï≠‚îÅ‚îÅ‚ù∞ ùó∫ùóºùóªùó≤ùòÜùó∏ùóÆùó∫ùóÆùóπùóº ‚ù±‚îÅ‚îÅ‚îÅ‚òÜ\n‚î£‚™ºüìÑ ùó£ùóÆùó¥ùó≤ùòÄ: ùüÆ\n‚î£‚™ºüíµ ùóîùòÉùó≤ùóøùóÆùó¥ùó≤ ùóñùó£ùó†: ‚Çπùü∞ùü¨ùü¨\n‚î£‚™ºüí≥ ùó™ùó∂ùòÅùóµùó±ùóøùóÆùòÑùóÆùóπ: $ùüØ.ùü≤ùü≠ / ‚ÇπùüØùü¨ùü¨\n‚î£‚™ºüåê ùó•ùó≤ùó≥ùó≤ùóøùóøùóÆùóπ ùóüùó∂ùóªùó∏: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](https://bit.ly/moneykamalo)\n‚î£‚™ºüìé ùóóùó≤ùó∫ùóº: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](http://earn.moneykamalo.com/FASmBFJ8)\n‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚òÜ\n\n‚ï≠‚îÅ‚îÅ‚îÅ‚îÅ‚ù∞ ùòáùó∂ùóΩùòÄùóµùóºùóøùòÅ ‚ù±‚îÅ‚îÅ‚îÅ‚îÅ‚òÜ\n‚î£‚™ºüìÑ ùó£ùóÆùó¥ùó≤ùòÄ: ùüÆ\n‚î£‚™ºüíµ ùóîùòÉùó≤ùóøùóÆùó¥ùó≤ ùóñùó£ùó†: ‚Çπùü∞ùüÆùü¨ \n‚î£‚™ºüí≥ ùó™ùó∂ùòÅùóµùó±ùóøùóÆùòÑùóÆùóπ: ‚Çπùü≠ùü±ùü¨\n‚î£‚™ºüåê ùó•ùó≤ùó≥ùó≤ùóøùóøùóÆùóπ ùóüùó∂ùóªùó∏: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](https://bit.ly/zipshort)\n‚î£‚™ºüìé ùóóùó≤ùó∫ùóº: [ùóñùóπùó∂ùó∞ùó∏ ùóõùó≤ùóÆùóø](https://zipshort.net/IRfy)\n‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚òÜ",
        reply_markup=reply_markup
    )

@Client.on_message(filters.command("plantutorial"))
async def forward_video(client, message: Message):
    try:
        # Replace this with the actual link of the video you want to forward
        video_link = "https://t.me/filmyspotupdate/76"  # Replace with the actual video link
        btn = InlineKeyboardMarkup(
            [[
                    InlineKeyboardButton("üí≥ …¢·¥á·¥õ ·¥ò Ä·¥á·¥ç…™·¥ú·¥ç :  Ä·¥á·¥ç·¥è·¥†·¥á ·¥Ä·¥Ös üí≥", url="https://cosmofeed.com/vig/65ae01464009dd001dc656d8")
                ],[
                    InlineKeyboardButton("·¥Ö·¥á ü·¥á·¥õ·¥á", callback_data="close_data")
                ]]
        )
        await client.send_video(
            chat_id=message.chat.id,
            video=video_link,
            caption="Here's the tutorial video you requested.",
            reply_markup=btn
        )
    except Exception as e:
        print(f"An error occurred: {e}")

